!function(e,n){"use strict";function t(){function e(i){i=i||{},"id"in i?c(i):n>0?(n--,setTimeout(function(){a(e)},t)):console.error("Unable to get lead from Marketo API even after waiting ",o," seconds")}var n=5,t=5e3,o=n*t/1e3;gc.loadAndInitMunchkin(e)}function a(e){gc.loadJSON("/wp-content/shared-gc/includes/rest-api/marketo/lookup-lead-by-cookie/?cache="+Math.random()).then(function(n){var t=n&&!n.error&&n.lead?n.lead:{};e(t)})}function c(n){n.id&&(e.dataLayer=e.dataLayer||[],e.dataLayer.push({mktoLeadId:n.id}),gc.mktoLead=n),lscache.set("mktoLead",n,15),o(),gc.mktoLead&&i()}function o(){gc.loadCachedJSON("segmentedCTAs","/wp-content/themes/timber-gc/js/json/segmented-ctas.json").then(function(e){n.body.classList.contains("timber-gc-theme")?gc.load("segmentedctas","~/js/dist/segmented-ctas.min.js?v=1").then(function(){gc.updateSegmentedCTAs(e)}):gc.load("segmentedCTAs","/wp-content/themes/genesis-gc/js/dist/load-segmented-cta.min.js?v=3").then(function(){gc.setupSegmentedCTAs(e)})})["catch"](function(e){console.error("Unable to fetch segmented CTA JSON",e)})}function i(){gc.load("stagebasedctas","~/js/dist/stage-based-ctas.min.js")}var d=lscache.get("mktoLead"),r=e.location.href.indexOf("mkt_tok=")!==-1;null!==d?"id"in d?c(d):r?t():o():r?t():n.cookie.indexOf("_mkto_trk=")!==-1?a(c):c({})}(window,document),!function(e){function n(e){"Pageview"===e.event?(t(e),a(e)):console.error("Invalid lead event:",e)}function t(e){function n(){l?f?s("Internal Pageview",r(l)):s("Referral Pageview",r(l)):s("Direct Pageview")}m&&s("Marketing Pageview",m),e.type?n():c(n)}function a(e){e.type?s("Lead Score Pageview",e.type):c(function(){s("Lead Score Pageview","Academic Landing Page")})}function c(n){if(h===!0)n();else if(null===h&&u.indexOf("/academics/")!==-1){var t="academic-landing-page-paths";gc.loadCachedJSON(t,"~/js/json/"+t+".json").then(function(t){for(var a=e.location.pathname.replace("/academics/","").split("/").filter(Boolean).join("/"),c=0;c<t.length;c++)if(t[c]===a)return h=!0,void n();h=!1})}}function o(){var e=i("utm_source"),n=i("utm_medium");if(e&&n){var t=i("utm_campaign")||"",a=i("utm_content")||"";return["source=",e,"/medium=",n,"/campaign=",t,"/content=",a].join("")}return!1}function i(n){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+n+"=([^&#]*)"),a=t.exec(e.location.search);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))}function d(){var n=e.location.hostname;return n.substring(n.lastIndexOf(".",n.lastIndexOf(".")-1)+1)}function r(e){return e.replace(/.*?:\/\//g,"").split(/[?#]/)[0]}function s(e,n){var t="";t+="http://"+e+" > ",n&&(t+=n+" | "),t+=r(u),gc.loadAndInitMunchkin(function(){console.log(t),Munchkin.munchkinFunction("clickLink",{href:t})})}var u=e.location.href,l=document.referrer,g=d(),f=l.indexOf(g)!==-1,m=o(),h=null;gc.trackLeadEvent=n;for(var v=gc.getLeadEvents(),p=0;p<v.length;p++)n(v[p])}(window);
//# sourceMappingURL=../sourcemaps/track-leads.min.js.map
